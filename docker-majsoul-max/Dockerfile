# Generated by Gemini 2.5 pro
# docker build -t recolic/maj .
# docker run -d -p 10802:10802 --name majsoul-proxy recolic/maj
## Usage: Use socks5 proxy, visit mitm.it, trust CA, enjoy.

FROM python:3.11-slim

RUN apt-get update && apt-get install -y git wget && pip install --no-cache-dir mitmproxy

WORKDIR /app

RUN git clone https://github.com/Avenshy/MajsoulMax.git .
RUN pip install --no-cache-dir -r requirements.txt

# optional. Recolic use the same cert for all hacks.
RUN wget https://recolic.cc/res/mitmproxy-ca-recolic.tar.gz -O /tmp/certs.tar.gz
RUN mkdir -p /root/.mitmproxy && tar -xzvf /tmp/certs.tar.gz -C /root/.mitmproxy && rm /tmp/certs.tar.gz

EXPOSE 10802
## HTTP Proxy
# CMD mitmdump -p 10802 -s addons.py
## Socks Proxy
CMD mitmdump --mode socks5 -p 10802 -s addons.py

